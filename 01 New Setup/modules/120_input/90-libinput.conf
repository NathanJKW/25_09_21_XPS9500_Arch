# =============================================================================
# 90-libinput.conf — Xorg input config (libinput) for touchpads & mice
#
# Put this file in one of:
#   • User scope (recommended for dotfiles):  ~/.config/xorg.conf.d/90-libinput.conf
#   • System scope (requires sudo):          /etc/X11/xorg.conf.d/90-libinput.conf
#
# Notes
# -----
# • This config is for the Xorg "libinput" driver (not the old "synaptics").
# • You can discover your devices with:    xinput list
# • Then inspect properties for a device:  xinput list-props "<DEVICE NAME>"
# • Most options below are booleans ("on"/"off") or simple strings.
#
# Common libinput options (per the Xorg libinput driver):
#   MatchIsTouchpad "on"         — apply this section to touchpads
#   Driver "libinput"            — use libinput driver
#   Tapping "on|off"             — 1/2/3-finger *tap* to click
#   TappingButtonMap "lmr|lrm"   — map finger count: Left/Middle/Right or Left/Right/Middle
#   TappingDrag "on|off"         — tap-and-drag (tap, then finger down to drag)
#   TappingDragLock "on|off"     — stay in drag mode after release until next tap
#   NaturalScrolling "true|false"— invert scroll direction (mac-style)
#   DisableWhileTyping "true|false" — ignore touchpad while typing
#   ScrollMethod "twofinger|edge|button" — how to scroll
#   ScrollButton <button number> — when method=button, which button toggles scrolling
#   ScrollButtonLock "true|false"— keep button-scroll active until next click
#   ClickMethod "none|buttonareas|clickfinger"
#       - buttonareas   : bottom-left/right “zones” are left/right click
#       - clickfinger   : # of fingers on click = which button (1=L, 2=M, 3=R)
#   MiddleEmulation "true|false" — emulate middle button by pressing L+R together
#   AccelProfile "adaptive|flat" — pointer acceleration curve
#   AccelSpeed "-1.0..1.0"       — pointer acceleration factor (0 = default)
#   LeftHanded "true|false"      — swap left/right buttons
#   SendEventsMode "enabled|disabled|disabled-on-external-mouse"
#   HorizontalScrolling "true|false" — allow horizontal scrolling
#   PalmDetection "on|off"       — reduce accidental touches (if supported)
#
# After editing, reload X (log out/in) or reboot. For testing toggles live:
#   xinput set-prop "<DEVICE>" "libinput Tapping Enabled" 1
# =============================================================================


# -------------------------------
# TOUCHPAD — sensible defaults
# -------------------------------
Section "InputClass"
    Identifier "libinput touchpad (sane defaults)"
    MatchIsTouchpad "on"
    Driver "libinput"

    # --- Clicks & tapping ---
    Option "Tapping" "on"                 # 1/2/3-finger tap = click
    Option "TappingButtonMap" "lmr"       # 1f=Left, 2f=Middle, 3f=Right
    Option "TappingDrag" "on"             # tap then drag with finger down
    Option "TappingDragLock" "off"        # set to "on" if you like drag-lock

    # --- Scrolling ---
    Option "ScrollMethod" "twofinger"     # alternatives: edge | button
    Option "NaturalScrolling" "true"      # Mac-style scrolling

    # --- Typing protection ---
    Option "DisableWhileTyping" "true"    # ignore touchpad while typing
    Option "PalmDetection" "on"           # reduce palm/thumb mis-touches if supported

    # --- Click mechanics ---
    # If your pad has physical bottom zones and clickfinger feels odd, try:
    # Option "ClickMethod" "buttonareas"
    Option "ClickMethod" "clickfinger"

    # --- Pointer feel ---
    Option "AccelProfile" "adaptive"      # 'flat' = constant speed, no accel
    Option "AccelSpeed" "0.2"             # -1..1 (small positive = a bit faster)

    # --- Misc ergonomics ---
    Option "LeftHanded" "false"
    Option "SendEventsMode" "enabled"     # or "disabled-on-external-mouse"
    Option "HorizontalScrolling" "true"
EndSection


# --------------------------------
# MOUSE — optional, modest tweaks
# --------------------------------
Section "InputClass"
    Identifier "libinput mouse (optional tweaks)"
    MatchIsPointer "on"
    MatchIsTouchpad "off"
    Driver "libinput"

    Option "AccelProfile" "adaptive"      # try "flat" for FPS-style mice
    Option "AccelSpeed" "0.0"             # neutral speed
    Option "MiddleEmulation" "false"      # set true if your mouse lacks middle
    Option "LeftHanded" "false"
EndSection


# ---------------------------------------------------------------------------
# Notes / Troubleshooting
# ---------------------------------------------------------------------------
# • If tapping still doesn’t work, confirm the device is a *touchpad* and uses
#   libinput (not synaptics):  xinput list  /  xinput list-props "<DEVICE>"
# • If the touchpad disappears when a USB mouse is connected, try:
#   Option "SendEventsMode" "disabled-on-external-mouse"
# • If scrolling feels wrong, test live:
#   xinput set-prop "<DEVICE>" "libinput Natural Scrolling Enabled" 1
#   xinput set-prop "<DEVICE>" "libinput Scroll Method Enabled" 0, 1, 0   # twofinger
# • If pointer feels too fast/slow:
#   tweak AccelSpeed (-1..1) or switch AccelProfile to "flat".
# • For horizontal scroll with two fingers, keep HorizontalScrolling "true".
# • To debug what options a device accepts, check Xorg log after restart:
#   grep -i libinput ~/.local/share/xorg/Xorg.0.log 2>/dev/null || true
